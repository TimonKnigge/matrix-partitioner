\documentclass{article}

\input{preamble.tex}

% Add commands here

% Decision problems
\newcommand{\mbpt}{\textsc{Matrix \allowbreak Bipartition} }
\newcommand{\gb}{\textsc{Graph \allowbreak Bisection} }
\newcommand{\geb}{\textsc{Graph \allowbreak Edge-\allowbreak Bisection} }
\newcommand{\bgeb}{
	\textsc{Bipartite \allowbreak Graph \allowbreak Edge-\allowbreak Bisection}
 }

\newcommand{\sgeb}{\textsc{GEB} }
\newcommand{\sgb}{\textsc{GB} }
% /commands

\begin{document}

	\section{Hardness results}
	In this section we will formally analyze the matrix partitioning
	problem and prove that it is \NP-Complete, even if we fix the
	the number of processors to $k = 2$. We will assume we are looking
	for a perfect partitioning, i.e. with imbalance parameter $\epsilon = 0$.

	\subsection{Preliminaries}
	To begin, let us define a formal decision-variant of the matrix
	partitioning problem for $k = 2$, based on the optimization
	variant described in \ref{introductory-section} where the goal
	is to minimize the total communication volume. We formulate our
	decision problems in the style of \cite{npbook}.

	\begin{problem}
		\problemtitle{\mbpt}
		\probleminput{A $n\times m$ matrix $M$, whose nonzeros are precisely
			indexed by the set
			$Z \subseteq \{\, 1, \dots, n \,\} \times
				\{\, 1, \dots, m \,\}$, and an integer $V$, the required
			maximum volume.}
		\problemquestion{Does there exist a disjoint partitioning of $Z$
			into $Z_1 \cup Z_2$ such that $|Z_1| = |Z_2|$ and volume
			$VOL(Z_1, Z_2) \leq V$?}
	\end{problem}

	Here $VOL(Z_1, Z_2)$ counts the number of rows and columns that
	have nonzeros in $Z_1$ and $Z_2$, as before.

	When thinking about the matrix bipartitioning problem, it is helpful
	to reformulate it in terms of graphs. Given an $n \times m$ matrix $M$
	we can define a bipartite adjacency graph $G(M) = (V(M), E(M))$ with
	$n$ vertices representing the rows of $M$, and $m$ vertices representing
	the columns, where a row vertex $r$ and a column vertex $c$ are connected
	if and only if $M_{rc}$ is nonzero.

	This equivalence extends to the partitioning problem. A bipartitioning of
	the nonzeros of $M$ corresponds to a bipartitioning of the edges of $G(M)$,
	and the rows and columns contributing to the final volume are correspond
	precisely to the vertices with edges in both sides of the partition. See
	also figure \ref{figure-for-graph-equiv}. \todo{Add image of graph equiv.}

	It should be clear this procedure is also reversible, i.e. for any
	bipartite graph we can construct a corresponding matrix.
	To this end we define an equivalent bipartitioning problem on graphs that
	we will base our reduction on:

	\begin{problem}
		\problemtitle{\bgeb}
		\probleminput{Given a bipartite graph
			$G = (L \cup R, E)$ and an integer
			$V$.}
		\problemquestion{Does there exist a disjoint partitioning of $E$
			into $E_1 \cup E_2$ such that $|E_1| = |E_2|$ and
			$\big|\big(\bigcup E_1 \big) \cap
				\big(\bigcup E_2 \big)\big| \leq V$?\footnote{
			Writing an edge as the set $\{ u, v\} \subset V$, then
			$\bigcup E_1$ gives precisely the set of vertices touched
			by $E_1$.}}
	\end{problem}

	We call a vertex with adjacent edges from both partitions `cut'. The
	goal is to minimize the amount of cut vertices.
	Next, we note:
	\begin{theorem}\label{bgeb-to-mbpt}
		\begin{equation}
			\begin{split}
			\mbpt &\leq_{\mathcal{P}} \bgeb \\ &\leq_{\mathcal{P}} \mbpt
			\end{split}
		\end{equation}
	\end{theorem}
	\begin{proof} This trivially follows from the construction described
		above.
	\end{proof}

	Hence, from now on we will focus on proving the hardness of \bgeb.
	To achieve this, we will use as a stepping stone the version of this
	problem where we remove the restriction that the graph is bipartite:

	\begin{problem}
		\problemtitle{\geb}
		\probleminput{As with $\bgeb$, but without the restriction that $G$
			is bipartite.}
		\problemquestion{As with $\bgeb$.}
	\end{problem}

	\subsection{\geb is \NP-Complete}
	We will do a reduction from \gb which was proven \NP-Complete in
	\cite{gb-np-complete} under the name \textsc{Minimum \allowbreak
	cut \allowbreak into \allowbreak equal-\allowbreak sized \allowbreak
	subsets}.

	\begin{problem}
		\problemtitle{\gb}
		\probleminput{A graph $G = (V, E)$, an integer $M$.}
		\problemquestion{Does there exist a disjoint partition of $V$
			into $V_1 \cup V_2$ with $|V_1| = |V_2|2$ and such that
			$|\{\, \{u, v\} \,\mid\, u \in V_1, v\in V_2 \,\}| \leq M$?}
	\end{problem}

	Analogously to \geb, an edge with endpoints in both sides of the
	partition is called `cut', the goal is to minimize the amount of
	cut edges.

	Let us give a sketch of our proof strategy:
	given an instance $(G, M)$ of the \gb problem, we
	will build a new graph $G'$, whose optimal solution under the 
	\geb problem will give us an optimal solution under \gb on $G$.

	Specifically, for each vertex $v \in V$ we create a clique $K_u$ of size
	$S$ (specified later). For every edge $\{u, v\} \in E$, we merge
	two vertices in the cliques $K_u$ and $K_v$ together into a single
	vertex. We then solve the \geb on the resulting graph $(V', E')$, and
	translate the resulting coloring of its edges into a coloring of the
	vertices of $(V, E)$. (Here, the colors correspond to sites in the
	partition.) We note that if we color each clique in $(V', E')$
	monochromatically with the color of its vertex in $(V, E)$, then
	an edge between two differently colored vertices in $(V, E)$ will
	correspond precisely with a vertex shared by two cliques in $(V', E')$.
	An example is given in \ref{figure-graph-clique-conversion}. We note that
	the \geb problem gives us no guarantee that each clique is colored
	monochromatically, but we will work around this later.
	\todo{Add image of coloring conversion}

	Formally, let us define the \textit{clique expansion} of a graph as follows:

	\begin{definition}
		\label{clique-expansion}
		Given a graph $G = (V, E)$,
		let $S = 4 + 2|V|\binom{|E|}{2}$.
		We define its clique expansion expansion
		$\mathcal{K}(G) = (V', E')$ as first taking a disjoint union of $|V|$
		copies of the complete graph on $S$ vertices $K_S$. Then, labelling the
		edges in $E$ as $e_1, e_2, \dots, e_{|E|}$, for each edge $e_i = \{u, v\}$
		we merge the $i^{th}$ vertex of the $K_S$ representing $u$ with the $i^{th}$
		vertex of the $K_S$ representing $v$.
	\end{definition}

	Here, the clique size $S$ will allow us to prove several
	useful propositions later. Notice that by construction, each pair of cliques is
	merged at most once, each time in a previously unmerged vertex. As a consequence,
	while cliques share vertices, they do not share edges.

	\begin{proposition}
		\label{poly-size}
		The size of $\mathcal{K}(G) = (V', E')$ is polynomial in the size of
		$G = (V, E)$.
	\end{proposition}
	\begin{proof}
		By construction, each vertex in $V$ induces a subgraph with $O(|V||E|^2)$
		vertices and $O(|V|^2|E|^4)$ edges. After merging, the graph will only
		become smaller. So $|V'|$ is $O(|V|^2 |E|^2)$ and $|E'|$ is $O(|V|^3|E|^4)$.
	\end{proof}

	So $\mathcal{K}(G)$ is of polynomial size and we can solve the \geb problem
	on it. We now want to show that both problems have equal optimal solutions (in
	the sense of an optimization problem, not a decision problem). For
	a graph $G=(V, E)$, let $\sgb(G)$ denote the optimal solution of the \gb
	problem on $G$, and let $\sgeb(\mathcal{K}(G))$ denote the optimal solution of
	the \geb problem on its \textit{clique expansion} $\mathcal{K}(G)$.

	\begin{proposition}
		\label{geb-leq-gb}
		For any graph $G$ we have $\sgeb(\mathcal{K}(G)) \leq \sgb(G)$.
	\end{proposition}
	\begin{proof}
		Consider any valid equipartitioning of $G = (V, E)$ of cost $C$ (that
		is, there are
		exactly $C$ edges with endpoints in both colors). For any vertex $c$,
		color all edges in the corresponding clique $K_u$ in $\mathcal{K}(G)
			= (V', E')$ with the same color.

		Since each clique $K_u$ in $\mathcal{K}(G)$ has the same number of
		edges ($\binom{S}{2}$), and by
		assumption the partitioning of $V$ is into two equal sized subsets, the
		strategy described above partitions $E'$ into two equal sized subsets.

		Now let $s$ be a vertex in $\mathcal{K}(G)$. If $s$ is contained in only
		one clique, it is not cut,
		since we color each $K_u$ monochromatically. If $s$ is shared by two
		cliques $K_u$ and $K_v$, then $s$ corresponds to the edge
		$e = \{u, v\} \in E$, and
		we can see that this vertex if and only if $e$ is cut (since $K_u$ and
		$K_v$ are colored like $u$ and $v$ respectively). Since by construction,
		each vertex is in at most two cliques, there is no ambiguity.

		So the number of cut vertices in the induced partitioning of
		$\mathcal{K}(G)$ is exactly the number of cut edges in the original
		partitioning of $G$. We can then minimize over all valid partitionings
		of $G$ to achieve the desired inequality.
	\end{proof}

	Unfortunately the converse is harder to prove since we cannot guarantee
	that an optimal partitioning of $\mathcal{K}(G)$ colors each edge
	monochromatically. It turns
	out however, that we can still deterministically associate a color with each
	clique, provided we have an \textbf{optimal coloring}.

	\begin{definition}
		Let $K$ be a clique and suppose we have a coloring of its edges. The
		dominating color of $K$ is a color $c$ such that there exists a vertex
		in $K$ with all of its adjacent edges colored $c$.
	\end{definition}

	While this property is clearly not well-defined in general, it is for our
	restricted case:

	\begin{lemma}
		\label{dom-col}
		Given a graph $G = (V, E)$ and an optimal partitioning of the edges
		of its clique
		expansion $\mathcal{K}(G)$. Then each clique $K_u$ in $\mathcal{K}(G)$
		has a well-defined dominating color.
	\end{lemma}
	\begin{proof}
		Fix a clique $K_u$ in $\mathcal{K}(G)$. We need to prove existence and
		uniqueness of its dominating color.

		First, uniqueness is trivial. To the contrary, assume there are to
		vertices $r, b$ in $K_u$ such that $r$ has only red edges adjacent,
		and $b$ only blue edges. Since $K_u$ is a clique, the edge $\{r, b\}$
		exists, which must be both red and blue, a contradiction.

		As for existence, assume to the contrary that every vertex in $K_u$
		has both blue and red edges adjacent. But this means each vertex in
		$K_u$ is cut by the partitioning, and the cost of this partitioning
		of $\mathcal{K}(G)$ is at least the clique size
		$S = 4+2|V|\binom{|E|}{2}$. One may verify that for any graph,
		$S > |E|$. However, $|E|$ is a trivial upperbound on the \gb problem
		on $(V, E)$, which, by \ref{geb-leq-gb} is an upperbound on the optimal
		partitioning of the edges of $\mathcal{K}(G)$. Together with the
		observation that the cut size is at least $S$, this contradicts the
		optimality of the partitioning of $\mathcal{K}(G)$. Hence there exists
		a vertex (at least $S-|E|$ in fact) that only has adjacent edges of
		a single color.
	\end{proof}

	Our strategy should now be obvious. We will color vertices in $G$ by
	the dominating color of their cliques in $\mathcal{K}(G)$.

	\begin{proposition}
		\label{gb-leq-geb}
		For any graph $G$ we have $\sgb(G) \leq \sgeb(\mathcal{K}(G))$.
	\end{proposition}
	\begin{proof}
		Fix any optimal partitioning of $\mathcal{K}(G) = (V', E')$, and
		color each vertex $u$ in $G = (V, E)$ with the dominating color of
		its associated clique $K_u$ in $\mathcal{K}(G)$. We would like to
		prove two things about this partitioning: that it equipartitions $V$,
		and that the number of cut edges in $G$ is no more than the number of
		cut vertices in $\mathcal{K}(G)$.

		\todo{Finish proof}.
	\end{proof}

	We can now conclude:

	\begin{theorem}
		$\gb \leq_{\mathcal{P}} \geb$
	\end{theorem}
	\begin{proof}
		For a given instance of \gb $(G, M)$, by \ref{geb-leq-gb} and
		\ref{gb-leq-geb} we know
		$\sgb(G) \leq M$ if and only if $\sgeb(\mathcal{K}(G)) \leq M$. So
		if we can solve \geb on $\mathcal{K}(GB)$ (which has size polynomial
		in the size of $G$, by \ref{poly-size}) in polynomial time, we can
		also solve \gb on $G$ in polynomial time.
	\end{proof}

	\subsection{\bgeb is \NP-Complete}
	\todo{Prove title}

	As a corollary of the above theorem, \ref{bgeb-to-mbpt} and the
	\NP-Completeness of \geb, we now get the main theorem of the section
	for free:

	\begin{theorem}
		\mbpt is \NP-Complete.
	\end{theorem}
	
\end{document}

\section{Introduction}
\label{sec:intro}
Sparse matrix partitioning is important for the parallel solution of sparse linear systems
by direct or iterative methods. In iterative solvers, the basic kernel is the multiplication
of a sparse matrix and a dense vector, the SpMV operation. A good partitioning of the sparse matrix
and the vector will balance the computation load in a parallel SpMV by spreading the
matrix nonzeros evenly over the parts assigned to the processors 
of the parallel computer and it will also
lead to less communication of the vector components between the processors.

In the past decades, much effort has been spent on developing and improving
heuristic partitioning methods. In particular, hypergraph methods have been very
successful because they model the communication volume (the total
number of data words sent) exactly, so that they can try to minimise the true metric.
Two-dimensional (2D) partitioning methods are superior to 1D methods,
since they are more general and can split both the rows and columns of the matrix and
hence in principle can provide better solutions.
Heuristic algorithms for hypergraph-based sparse matrix partitioning
have been implemented in the sequential software packages hMetis~\cite{karypis99b},
PaToH~\cite{catalyurek99}, Mondriaan~\cite{vastenhouw05}, KaHyPar~\cite{akhremtsev17},
and the parallel packages Par$k$way~\cite{trifunovic08} and Zoltan~\cite{devine06}.
The current state-of-the art methods for 2D sparse matrix partitioning are the fine-grain~\cite{catalyurek01}
and the medium-grain method~\cite{pelt14}. 

How good are the current methods and is it still worthwhile to improve them?
To answer this question we need to compare the quality of the outcome,
i.e., the communication volume, to the optimal result.
To enable such a comparison, we need an exact algorithm that provides the 
minimum communication volume for a specfied maximum load imbalance.
The first exact algorithm for this problem (with two parts)
was proposed by Pelt and Bisseling~\cite{pelt15}.
It is based on a branch-and-bound method that distinguishes  between
three cases for every row and column of the sparse matrix:
completely assigned to part 0, completely assigned to part 1, 
or split between the two parts. This algorithm has been implemented
in the program MondriaanOpt, included in the Mondriaan package,
version 4.2. As of today, 356 matrices from the SuiteSparse 
(formerly University of Florida) sparse matrix collection~\cite{davis11}
have been bipartitioned to optimality by MondriaanOpt. 
\footnote{The solutions can be found at
\url{http://www.staff.science.uu.nl/~bisse101/Mondriaan/Opt/}.}
Being able to increase the size of the solution subset would be valuable
for benchmarking heuristic partitioners, by providing more comparison data and also  
for more realistic problem sizes. Heuristic partitioners are aimed at large 
problems, though they will encounter smaller problems after their inital splits.

Optimal partitionings are easiest to compute for splitting into two parts:
the required computation time
grows quickly with a larger number of parts, as discussed in~\cite{pelt15}.
Furthermore, heuristic partitioners often are based on recursive bipartitioning,
so that it is most important to gauge the quality of the bipartitioner.
(A notable exception is KaHyPar, which computes a direct $k$-way partitioning.)
Therefore, both the exact partitioner implemented in MondriaanOpt and the improved partioner 
MP (for Matrix Partitioner)
presented in this article, compute optimal solutions for bipartitioning.

Another question that arises is about the \NP-completeness~\cite{garey79}
of the sparse matrix bipartitioning problem.
It is known that the decision problem of
graph bipartitioning with a tolerated imbalance
is \NP-complete~\cite[Theorem 3.1]{bui92}
and so is hypergraph partitioning~\cite[Chapter 6]{lengauer90}, 
but sparse matrix bipartitioning is a special
case of hypergraph bipartitioning (for instance, with vertices contained in only two hyperedges),
and its decision problem is expected to be \NP-complete,
but this has not been proven yet.

The novelty of this paper is twofold: (i) we present an improvement
of the previous exact algorithm from~\cite{pelt15} by generalising
a matching-based lower bound on the necessary communication
to a stronger maximum flow-based bound; and by generalising a packing
bound (using ideas from ~\cite{delling14}); (ii) we formulate the balanced sparse matrix bipartitioning problem
and prove its \NP-completeness.

The sparse matrix bipartitioning problem that
we solve by an exact algorithm can be formulated as follows.
Given an $m \times n$ sparse matrix with $|A|$ nonzeros
and an allowed imbalance fraction of $\epsilon \geq 0$,
find disjoint subsets $A_0, A_1 \subseteq A$ such that
\begin{equation}
A=A_0 \cup A_1,
\end{equation}
and
\begin{equation}
\label{eqn:imbal}
|A_i| \leq (1+\epsilon ) \left\lceil \frac{|A|}{2} \right\rceil ,
~\mathrm{for}~ i=0,1,
\end{equation}
and such that the communication volume $V(A_0,A_1)$ is minimal.

Here, the \emph{communication volume} is
defined as the total number of rows and columns 
that have nonzeros in both subsets.
Each of these \emph{cut} rows and columns gives rise to one communication
in a parallel SpMV.
Eqn~(\ref{eqn:imbal}) represents a constraint on the load balance
of two processors of a parallel computer executing the SpMV. 

In this paper, we will only consider the communication volume
as the metric to be minimised. 
Note that other possible objectives, such as 
minimising the maximum communication volume per processor
or minimising the total number of messages, 
may also be relevant for a larger numbers of parts,
but not for two parts.

Many exact partitioning algorithms have been developed for graphs~\cite{karisch00,sensen01,felner05,hager13,delling14}. All these algorithms minimise the edge cut,
not the communication volume.
Felner~\cite{felner05} solves a graph partitioning problem
with uniform edge weights to optimality
with a purely combinatorial branch-and-bound method,
reaching up to 100 vertices and 1000 edges.
Delling~\textit{et al.\ }\cite{delling14} solved larger problems
using packing-tree bounds and graph contractions, and they solved 
the open street map problem \texttt{luxembourg} with
114,599 vertices and 119,666 edges in less than a minute.

For hypergraphs, much less work has been
done on exact partitioning~\cite{caldwell00,kucar04,bisseling05}.
Kucar~\cite{kucar04} uses integer linear programming (ILP) 
to solve a problem with 1888 vertices, 1920 nets (hyperedges), and 5471
pins (nonzeros) in three days of CPU time; the heuristic solver
hMetis~\cite{karypis99b}
managed to find a solution in less than a second for the same problem,
and it turned out to be optimal.
Bisseling and his team members~\cite{bisseling05}
solved an industrial call-graph problem
by formulating it as a hypergraph partitioning problem with the cut-net metric,
and they solved it heuristically by using Mondriaan
and exactly by an ILP method (in 9 days of CPU time).

For exact sparse matrix partitioning,
the problem could in principle be formulated
as a hypergraph bipartitioning problem by using
the fine-grain model~\cite{catalyurek01}:
each matrix nonzero becomes a vertex in the hypergraph;
the nonzeros in a row are connected by a row-net  
and the nonzeros in a column by a column-net.
Thus, we obtain a hypergraph with $|A|$ vertices and $m+n$ nets,
with the special property that each vertex is
contained in precisely two nets.
One of these nets thus belongs to a group of $m$ row-nets, and the other to
a group of $n$ column-nets. Furthermore, no two vertices have the same pair
of nets.
An exact general hypergraph partitioner could then be used to solve
the problem to optimality. 
This, however, is less efficient than direct exact sparse matrix partitioning,
since the hypergraph partitioner would not exploit the special properties.
In contrast, the direct matrix approach imposes them
by construction.

Our previous work~\cite{pelt15} presented the first direct
exact matrix partitioner, implemented in the open-source software
MondriaanOpt. This work was extended by Mumcuyan
and coworkers~\cite{mumcuyan18} who 
reordered the matrix given to MondriaanOpt,
automatically choosing the best reordering method
from a set of methods by a machine-learning approach,
and by parallelising the software for a shared-memory computer
using OpenMP. 
Our own improvements, in the present article,
are orthogonal to these extensions,
so that they can be combined.  

The remainder of this paper is organised as follows:
Section~\ref{sec:np} presents the \NP-completeness proof 
for sparse matrix bipartitioning.
Section~\ref{sec:opt} briefly reviews the
branch-and-bound algorithm of~\cite{pelt15}
that was implemented in MondriaanOpt, and presents the generalised bounds
and their implementation.
Section~\ref{sec:experiments} presents the experimental results,
comparing MP to MondriaanOpt for 233 small matrices, 
and giving results for 599 larger matrices that could not be solved
by MondriaanOpt within the allotted time.
Section~\ref{sec:concl} presents the conclusions and discusses possible future
work.

